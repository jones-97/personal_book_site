<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Access Page</title>
    <link rel="stylesheet" href="admin.css" />
    
	<script type="text/javascript"> 
    const token = localStorage.getItem('adminToken');

fetch('http://localhost:5000/api/admin/dashboard', {
  method: 'GET',
  headers: { 'Authorization': `Bearer ${token}` },
})
.then((response) => response.json())
.then((data) => console.log(data))
.catch((error) => console.error('Error:', error));</script>

</head>

<body>

    <div class="header">
    ACCESS PAGE
    
    <button onclick="backHome()">Return</button>
    </div>
   
    <div class="content">
        <p class="note">Note that this section is meant for site admin.</p>
        
        <div class="form-container">
            <form id ="admin-login-form" >
                <label for="password">Password:</label>
                <input type="password" id="password" name="password">
                <a href="/forgot_password.html" class="forgot-password">Forgot password?</a>
                <button type="submit" class="login-btn" onclick="log_user">Login</button>
            </form>
        </div>
    </div>
 <script type="text/javascript"> 
 	document.getElementById('admin-login-form').addEventListener('submit', async (e) => {
  e.preventDefault();

  const password = document.getElementById('password').value;

  try {
    const response = await fetch('http://localhost:5000/api/admin/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ password }),
    });

    const data = await response.json();

    if (response.ok) {
      localStorage.setItem('adminToken', data.token); // Store the token
      window.location.href = 'site_settings.html'; // Redirect to dashboard
    } else {
      alert("Wrong password. Try again");
    }
  } catch (err) {
    console.error('Error during login:', err);
  }
});
 </script>
 <script> 
 
 function backHome() {
 window.location.href = "books.html";
 }
 </script>
    
</body>
</html>
