<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Password</title>
    <link rel="stylesheet" href="admin.css" />
</head>
<body>
    <div class="header">RESET PASSWORD
    <button onclick="backHome()">Return</button></div>
    <div class="content">
        <p class="message">A reset link has been sent to your email(s) containing the reset code.</p>
        <div class="form-container">
            <form id="reset-form">
                <label for="reset-code">Reset Code:</label>
                <input type="text" id="reset-code" name="reset-code">

                <label for="new-password">New Password:</label>
                <input type="password" id="new-password" name="new-password">

                <label for="confirm-password">Confirm New Password:</label>
                <input type="password" id="confirm-password" name="confirm-password">

                <button type="submit" class="reset-btn">Submit</button>
            </form>
        </div>
    </div>
    
    <script> 
	
	
	
    
  	document.getElementById('reset-form').addEventListener('submit', async (e) => {
            e.preventDefault();

            const resetCode = document.getElementById('reset-code').value;
            const newPassword = document.getElementById('new-password').value;
			const confirmPassword = document.getElementById('confirm-password').value;
			
			if (resetCode === "") {
		alert("Verification code needed");
	}
			
	if (newPassword || confirmPassword == "")
			{
		alert("Put something!");
			}
			
	if (newPassword != confirmPassword) {
		alert("Password does not match");
			}

            const response = await fetch('/api/admin/reset-password', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ resetCode, newPassword })
            });

            const data = await response.json();
            alert(data.message);
            if (response.ok) window.location.href = "access_page.html";
        });
    function backHome() {
		window.location.href="/admin";
	}
    
    </script>
</body>
</html>
